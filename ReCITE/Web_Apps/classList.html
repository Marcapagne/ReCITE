<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <style>
        html,
        body {
            /*border: 1px solid black;*/
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
        }

        img {
            margin-right: 10px;
            height: 20px;
            width: auto;
            cursor: pointer;
        }

        table {
            table-layout: auto;
            width: 100%;
        }
    </style>
     <script src="https://www.w3schools.com/lib/w3.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.1.1/firebase-database.js"></script>
</head>

<body>
    <table id="myTable" class="w3-table-all" width="auto">
        <tr>
                <th onclick="w3.sortHTML('#myTable', '.item', 'td:nth-child(1)')" style="cursor:pointer">Name</th>
                <th onclick="w3.sortHTML('#myTable', '.item', 'td:nth-child(2)')" style="cursor:pointer">Score</th>
                <th style="cursor:pointer">Action</th>
         </tr>
        
        <tbody id="main">
          <div id="elementHolder"></div>
        </tbody>
    </table>
    <script>
  const firebaseConfig = {
    apiKey: "AIzaSyBHcokPUxsadjWEnRugBcjSZERODdTnPVo",
    authDomain: "curriculum-9f921.firebaseapp.com",
    databaseURL: "https://curriculum-9f921-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "curriculum-9f921",
    storageBucket: "curriculum-9f921.appspot.com",
    messagingSenderId: "850351009105",
    appId: "1:850351009105:web:b8a53325f995a656cb7770",
    measurementId: "G-X5NRSY58F5"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  var database = firebase.database();
  var ref = database.ref('classList/BTVTEd');

  let data = [];
  let keys = [];

  ref.on('value', function (snapshot) {
    snapshot.forEach(element => {
      keys.push(element.key);
    });
    getStudentData();
    // snapshot.forEach(element => {
    //   var item = {
    //     'score': element.val().score,
    //     'name': element.val().name
    //   }
    //   segments.push(item);
    // });
    // createTableItems();
  });


  function getStudentData() {
    keys.forEach(e => {
      var ref = database.ref('classList/BTVTEd/'+ e);
      

      ref.on('value', function (element) {
          var item = {
            'score': element.val().score,
            'name': element.val().name
          }
          segments.push(item);
      });
      createTableItems();
    })
  }

  function createTableItems() {
    segments.sort((a, b) => (a.score > b.score ? -1 : 1));

    let main = document.getElementById("main");
    segments.forEach(student => {
      let tr = document.createElement("tr");
      tr.className = 'item';
      let td_name = document.createElement("td");
      let name = document.createTextNode(student['name']);
      let td_score = document.createElement("td");
      let score = document.createTextNode(student['score']);
      let td_Actions = document.createElement("td");
      let edit = document.createElement("img");
      edit.src = "../Resources/edit.png";
      let deleteicon = document.createElement("img");
      deleteicon.src = "../Resources/delete.png";
    
      td_name.appendChild(name);
      td_score.appendChild(score);
      td_Actions.appendChild(edit);
      td_Actions.appendChild(deleteicon);                  
      tr.appendChild(td_name);
      tr.appendChild(td_score);
      tr.appendChild(td_Actions);     

      main.appendChild(tr)
    })
  }

  function addData() {
    var data = {
      name: "SSS",
      score: 232
    }
    ref.push(data);
  }

  //  SAMPLE PALANG TO tanggalin yung ibang yan pag mdarami na laman ng data
  let segments = [
  ];



</script>
</body>

</html>
